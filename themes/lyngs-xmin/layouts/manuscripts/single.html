{{ partial "header.html" . }}


<div class="main-container container-fluid">
  <main class="manuscript-page">
    <div class="row manuscript-info">
      <div class="col-sm-1 back-to-list"> 
        <a href="/sakta/"><i class="fa fa-backward fa-3x"></i></a>
      </div>
      
      {{/* INSERT METADATA */}}
      <div class="col-sm-8">
        <h2 data-toc-skip><span class="title">{{ .Title | markdownify }}</span></h2>
        {{ if .Params.sanskritTitle }} <p>Sanskrit title: {{ .Params.sanskritTitle }}</p> {{ end }}
        {{ if .Params.transliteratedTitle }} <p>Transliterated title: {{ .Params.transliteratedTitle }}</p> {{ end }}
        {{ if .Params.englishTitle }} <p>English title: {{ .Params.englishTitle }}</p> {{ end }}
        {{ if .Params.subject }} <p>Subject: {{ .Params.subject }}</p> {{ end }}
        {{ if .Params.approximateDating }} <p>Approximate dating: {{ .Params.approximateDating }} (<a href="https://danam.cats.uni-heidelberg.de/date-conversion-chart/">Date conversion chart</a>)</p> {{ end }}
        {{ if .Params.physicalLocation }} <p>Physical location: {{ .Params.physicalLocation }}</p> {{ end }}
        {{ if .Params.originPlace }} <p>Place of origin: {{ .Params.originPlace }}</p> {{ end }}
        {{ if .Params.author }} <p>Author: {{ .Params.author }}</p> {{ end }}
        {{ if .Params.provenance }} <p>Provenance: {{ .Params.provenance }}</p> {{ end }}
        {{ if .Params.manuscriptLanguage }} <p>Manuscript language: {{ .Params.manuscriptLanguage }}</p> {{ end }}
        {{ if .Params.script }} <p>Script: {{ .Params.script }}</p> {{ end }}
        {{ if .Params.material }} <p>Material: {{ .Params.material }}</p> {{ end }}
        {{ if .Params.condition }} <p>Condition: {{ .Params.condition }}</p> {{ end }}
        {{ if .Params.folios }} <p>Folios: {{ .Params.folios }}</p> {{ end }}
        {{ if .Params.codices }} <p>Codices: {{ .Params.codices }}</p> {{ end }}
        {{ if .Params.bibliographyNote }} <p>Bibliography: {{ .Params.bibliographyNote }}</p> {{ end }}
        {{ if .Params.transliterators }} <p>Transliterated by: {{ .Params.transliterators }}</p> {{ end }}
        {{ if .Params.translationEnglish }} <p>English translation by: {{ .Params.translationEnglish }}</p> {{ end }}
        {{ if .Params.translationDanish }} <p>Danish translation by: {{ .Params.translationDanish }}</p> {{ end }}
      </div>
      
      {{/* INSERT BUTTONS ON THE RIGHT (comment on gsheet, etc.) */}}
      <div class="col-sm-3">
        <div class="text-buttons">
        {{ if .Params.hasText }} <a href={{ .Params.googlesheet }} class="btn btn-light btn-md" role="button"><i class="fa fa-pencil"></i> Comment on text</a>  {{ end }}
        {{ if and .Params.hasText .Params.hasPhotos .Params.textOnlyVersion}}
          <br> <a href="/manuscripts/{{ .Params.catalogueId }}/1/" role="button" class="btn btn-light btn-md"><i class="fa fa-file-picture-o"></i> View manuscript photos</a>
        {{ end }}
        {{ if and .Params.hasText .Params.hasPhotos (not .Params.textOnlyVersion)}}
          <br> <a href="/manuscripts/{{ .Params.catalogueId }}/text-only/" role="button" class="btn btn-light btn-md"><i class="fa fa-file-text-o"></i> View text only</a>
        {{ end }}
        </div>
        
        {{ if and .Params.hasText .Params.hasPhotos (not .Params.textOnlyVersion)}}
        <div class="alert alert-info text-navigation-info" role="alert">
          To move the text, hold down the Option (&#8997;; Mac) or Alt key, then click and drag on the text. Reset with the <strong>Reset text</strong> button.
        </div>
        {{ end }}
        
      </div>
        
    </div>
    
    
    <div class="row manuscript-content">
      <div class="col-sm-12">
        {{/* INSERT CONTENT FROM RMD FILE */}}
        <div class="post-content" id="manuscript-content-anchor">
          {{ .Content }}
        </div>
        
        {{/* INSERT MANUSCRIPT IMAGE NAV BUTTONS (if there's images) */}}
        {{ if not .Params.textOnlyVersion}}
          <div class="manuscript-nav">
            {{ $manuscriptPath := print "/manuscripts/" .Params.catalogueId }}
            {{ $curImage := .Params.imageCurrent | int }}
            {{ $totalImages := .Params.imagesTotal | int }}
            {{ $lastUrlElement := index (last 1 (split (delimit (split .URL "/") "," "") ",")) 0 }}
            
            <a {{ if gt $curImage 1 }} href="{{ $manuscriptPath }}/{{ sub $curImage 1 }}/#manuscript-content-anchor" {{ end }} class="manucript-nav-button previous">Previous</a>
            
            {{ if lt $totalImages 8 }}
            
              {{ range $i, $sequence :=  (seq $totalImages) }}
                <a href="{{ $manuscriptPath }}/{{ add $i 1 }}/#manuscript-content-anchor" class="manucript-nav-button {{ if eq (add $i 1) ($lastUrlElement | int) }}current{{ end }}">{{ add $i 1 }}</a>
              {{ end }}
            
            {{ else }}
            
              {{ if lt $curImage 8 }}
                
                {{ range $sequence :=  (seq 12) }}
                <a href="{{ $manuscriptPath }}/{{ $sequence }}/#manuscript-content-anchor" class="manucript-nav-button {{ if eq $sequence ($lastUrlElement | int) }}current{{ end }}">{{ $sequence }}</a>
                {{ end }}
                
                <span class="ellipsis">...</span>
                
                <a href="{{ $manuscriptPath }}/{{ $totalImages }}/#manuscript-content-anchor" class="manucript-nav-button">{{ $totalImages }}</a>
                
              {{ else if (and (ge $curImage 5) (lt $curImage (sub $totalImages 6)))  }}
                <a href="{{ $manuscriptPath }}/1/#manuscript-content-anchor" class="manucript-nav-button">1</a>
                
                {{if gt $curImage 8}}<span class="ellipsis">...</span>{{end}}
                
                {{ range $sequence :=  (seq (sub $curImage 5) (add $curImage 5)) }}
                <a href="{{ $manuscriptPath }}/{{ $sequence }}/#manuscript-content-anchor" class="manucript-nav-button {{ if eq $sequence ($lastUrlElement | int) }}current{{ end }}">{{ $sequence }}</a>
                {{ end }}
                
                <span class="ellipsis">...</span>
                
                <a href="{{ $manuscriptPath }}/{{ $totalImages }}/#manuscript-content-anchor" class="manucript-nav-button">{{ $totalImages }}</a>
              
              {{ else if (ge $curImage (sub $totalImages 6))  }}
              
                <a href="{{ $manuscriptPath }}/1/#manuscript-content-anchor" class="manucript-nav-button">1</a>
                <span class="ellipsis">...</span>
                
                {{ range $sequence :=  (seq (sub $totalImages 12) $totalImages) }}
                <a href="{{ $manuscriptPath }}/{{ $sequence }}/#manuscript-content-anchor" class="manucript-nav-button {{ if eq $sequence ($lastUrlElement | int) }}current{{ end }}">{{ $sequence }}</a>
                {{ end }}
                
              
              {{ end }}
            
            {{ end }}
            
            <a {{ if lt $curImage $totalImages }} href="{{ $manuscriptPath }}/{{ add $curImage 1 }}/#manuscript-content-anchor" {{ end }} class="manucript-nav-button next">Next</a>
            
          </div>
        {{ end }}
        
      </div>
    </div>
    
    {{/* INSERT OVERLAY DIVS */}}
    {{ if not .Params.textOnlyVersion}}
  <div id="myNav" class="overlay">
    <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
    <div class="zoomButtonsFullScreen">
      <button class="manuscript-photo-button" id="zoomInFullScreen"><i class="fa fa-search-plus"></i></button>
      <button class="manuscript-photo-button" id="zoomOutFullScreen"><i class="fa fa-search-minus"></i></button>
      <button class="manuscript-photo-button" id="zoomResetFullScreen">Reset image</button>
      <button class="manuscript-photo-button" onclick="highResFull()">Resolution</button>

    {{ if .Params.hasText }}
      <button class="manuscript-photo-button" class="showTextbtn" onclick="showText()">Show/hide text</button>
      {{/* event listeners assigned in js/panzoom-elements.js */}}
      <button id="textZoomInFull" class="manuscript-photo-button">Text <i class="fa fa-search-plus"></i></button>
      <button id="textZoomOutFull" class="manuscript-photo-button">Text <i class="fa fa-search-minus"></i></button>
      <button class="manuscript-photo-button" onclick="resetTransform()">Reset text</button>
    {{ end }}
  
    </div>
    <div class="panzoomContainer overlay-content" id="fullScreenPhoto">
      <p class="medium-image-size-overlay">{{ .Params.photoSizeMedium }}</p>
      <p class="high-image-size-overlay">{{ .Params.photoSizeHigh }}</p>
      <img data-src-md-res="{{ .Params.photoPathMedium }}" data-src-high-res="{{ .Params.photoPathHigh }}" class="img-fluid">
    </div>
  </div>

{{ end }}
    
  </main>
</div>

{{/* INSERT JS */}}
{{ if and (not .Params.textOnlyVersion) (.Params.hasPhotos) }}
  <script>
    function openNav() {
      document.getElementById("myNav").style.width = "100%";
      var image = document.querySelector("#myNav img");
      image.src = image.getAttribute("data-src-md-res");
    }    
    
    function closeNav() {
      document.getElementById("myNav").style.width = "0%";
    }
  </script>
  
  {{ if .Params.hasText }}
    {{ partial "panzoom_text.html" . }} {{/* zoom text (must be before zoom images) */}}
  {{ end }}

  {{ partial "panzoom_images.html" . }} {{/* zoom images */}}
  
{{ end }}

{{ partial "footer.html" . }}
